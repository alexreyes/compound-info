SELECT 
    DAI.block_hour as block_time,
    BAT.supply_apy as BAT_supply_apy,
    BAT.borrow_apy as BAT_borrow_apy,
    BAT.total_supply_apy as BAT_total_supply_apy,
    BAT.total_borrow_apy as BAT_total_borrow_apy,
    COMP.supply_apy as COMP_supply_apy,
    COMP.borrow_apy as COMP_borrow_apy,
    COMP.total_supply_apy as COMP_total_supply_apy,
    COMP.total_borrow_apy as COMP_total_borrow_apy,
    DAI.supply_apy as DAI_supply_apy,
    DAI.borrow_apy as DAI_borrow_apy,
    DAI.total_supply_apy as DAI_total_supply_apy,
    DAI.total_borrow_apy as DAI_total_borrow_apy,
    ETH.supply_apy as ETH_supply_apy,
    ETH.borrow_apy as ETH_borrow_apy,
    ETH.total_supply_apy as ETH_total_supply_apy,
    ETH.total_borrow_apy as ETH_total_borrow_apy,
    UNI.supply_apy as UNI_supply_apy,
    UNI.borrow_apy as UNI_borrow_apy,
    UNI.total_supply_apy as UNI_total_supply_apy,
    UNI.total_borrow_apy as UNI_total_borrow_apy,
    USDC.supply_apy as USDC_supply_apy,
    USDC.borrow_apy as USDC_borrow_apy,
    USDC.total_supply_apy as USDC_total_supply_apy,
    USDC.total_borrow_apy as USDC_total_borrow_apy,
    USDT.supply_apy as USDT_supply_apy,
    USDT.borrow_apy as USDT_borrow_apy,
    USDT.total_supply_apy as USDT_total_supply_apy,
    USDT.total_borrow_apy as USDT_total_borrow_apy,
    WBTC.supply_apy as WBTC_supply_apy,
    WBTC.borrow_apy as WBTC_borrow_apy,
    WBTC.total_supply_apy as WBTC_total_supply_apy,
    WBTC.total_borrow_apy as WBTC_total_borrow_apy,
    WBTC2.supply_apy as WBTC2_supply_apy,
    WBTC2.borrow_apy as WBTC2_borrow_apy,
    WBTC2.total_supply_apy as WBTC2_total_supply_apy,
    WBTC2.total_borrow_apy as WBTC2_total_borrow_apy,
    ZRX.supply_apy as ZRX_supply_apy,
    ZRX.borrow_apy as ZRX_borrow_apy,
    ZRX.total_supply_apy as ZRX_total_supply_apy,
    ZRX.total_borrow_apy as ZRX_total_borrow_apy
FROM
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cBAT') as BAT,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cCOMP') as COMP,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cDAI') as DAI,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cETH') as ETH,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cUNI') as UNI,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cUSDC') as USDC,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cUSDT') as USDT,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cWBTC') as WBTC,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cWBTC2') as WBTC2,
    (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cZRX') as ZRX
WHERE
    hour(block_time) = 12 AND
    BAT.block_hour = block_time AND
    COMP.block_hour = block_time AND
    DAI.block_hour = block_time AND
    ETH.block_hour = block_time AND
    UNI.block_hour = block_time AND
    USDC.block_hour = block_time AND
    USDT.block_hour = block_time AND
    WBTC.block_hour = block_time AND
    WBTC2.block_hour = block_time AND
    ZRX.block_hour = block_time 
ORDER BY block_time DESC