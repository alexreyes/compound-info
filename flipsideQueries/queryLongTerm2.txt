WITH
    BAT as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cBAT'),
    COMP as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cCOMP'),
    DAI as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cDAI'),
    ETH as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cETH'),
    UNI as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cUNI'),
    USDC as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cUSDC'),
    USDT as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cUSDT'),
    WBTC as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cWBTC'),
    WBTC2 as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cWBTC2'),
    ZRX as (SELECT
        block_hour,
        supply_apy,
        borrow_apy,
        supply_apy + comp_apy_supply as total_supply_apy,
        borrow_apy + comp_apy_borrow as total_borrow_apy
    FROM
        compound.market_stats
    WHERE
        contract_name = 'cZRX')
SELECT
    DAI.block_hour as block_time,
    BAT.supply_apy * 100 as BAT_supply_apy,
    BAT.borrow_apy * 100 as BAT_borrow_apy,
    BAT.total_supply_apy * 100 as BAT_total_supply_apy,
    BAT.total_borrow_apy * 100 as BAT_total_borrow_apy,
    COMP.supply_apy * 100 as COMP_supply_apy,
    COMP.borrow_apy * 100 as COMP_borrow_apy,
    COMP.total_supply_apy * 100 as COMP_total_supply_apy,
    COMP.total_borrow_apy * 100 as COMP_total_borrow_apy,
    DAI.supply_apy * 100 as DAI_supply_apy,
    DAI.borrow_apy * 100 as DAI_borrow_apy,
    DAI.total_supply_apy * 100 as DAI_total_supply_apy,
    DAI.total_borrow_apy * 100 as DAI_total_borrow_apy,
    ETH.supply_apy * 100 as ETH_supply_apy,
    ETH.borrow_apy * 100 as ETH_borrow_apy,
    ETH.total_supply_apy * 100 as ETH_total_supply_apy,
    ETH.total_borrow_apy * 100 as ETH_total_borrow_apy,
    UNI.supply_apy * 100 as UNI_supply_apy,
    UNI.borrow_apy * 100 as UNI_borrow_apy,
    UNI.total_supply_apy * 100 as UNI_total_supply_apy,
    UNI.total_borrow_apy * 100 as UNI_total_borrow_apy,
    USDC.supply_apy * 100 as USDC_supply_apy,
    USDC.borrow_apy * 100 as USDC_borrow_apy,
    USDC.total_supply_apy * 100 as USDC_total_supply_apy,
    USDC.total_borrow_apy * 100 as USDC_total_borrow_apy,
    USDT.supply_apy * 100 as USDT_supply_apy,
    USDT.borrow_apy * 100 as USDT_borrow_apy,
    USDT.total_supply_apy * 100 as USDT_total_supply_apy,
    USDT.total_borrow_apy * 100 as USDT_total_borrow_apy,
    WBTC.supply_apy * 100 as WBTC_supply_apy,
    WBTC.borrow_apy * 100 as WBTC_borrow_apy,
    WBTC.total_supply_apy * 100 as WBTC_total_supply_apy,
    WBTC.total_borrow_apy * 100 as WBTC_total_borrow_apy,
    WBTC2.supply_apy * 100 as WBTC2_supply_apy,
    WBTC2.borrow_apy * 100 as WBTC2_borrow_apy,
    WBTC2.total_supply_apy * 100 as WBTC2_total_supply_apy,
    WBTC2.total_borrow_apy * 100 as WBTC2_total_borrow_apy,
    ZRX.supply_apy * 100 as ZRX_supply_apy,
    ZRX.borrow_apy * 100 as ZRX_borrow_apy,
    ZRX.total_supply_apy * 100 as ZRX_total_supply_apy,
    ZRX.total_borrow_apy * 100 as ZRX_total_borrow_apy
FROM DAI
   full outer join BAT on BAT.block_hour = DAI.block_hour
   full outer join COMP on COMP.block_hour = DAI.block_hour
   full outer join ETH on ETH.block_hour = DAI.block_hour
   full outer join UNI on UNI.block_hour = DAI.block_hour
   full outer join USDC on USDC.block_hour = DAI.block_hour
   full outer join USDT on USDT.block_hour = DAI.block_hour
   full outer join WBTC on WBTC.block_hour = DAI.block_hour
   full outer join WBTC2 on WBTC2.block_hour = DAI.block_hour
   full outer join ZRX on ZRX.block_hour = DAI.block_hour
WHERE
    hour(block_time) = 12
ORDER BY block_time ASC